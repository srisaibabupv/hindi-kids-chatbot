<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>Interactive Hindi Story Chatbot</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background: linear-gradient(to bottom, #fffae6, #ffe6f0);
    }
    #story {
      font-size: 24px;
      margin: 20px auto;
      padding: 20px;
      width: 90%;
      min-height: 150px;
      background: #fff3e6;
      border-radius: 15px;
      box-shadow: 2px 2px 12px rgba(0,0,0,0.2);
    }
    button {
      font-size: 20px;
      padding: 15px 30px;
      margin: 10px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background-color: #ff9966;
      color: white;
    }
    button:hover {
      background-color: #ff6600;
    }
    .optionBtn {
      display: block;
      margin: 10px auto;
      width: 70%;
    }
  </style>
</head>
<body>

<h1>ЁЯОЙ Interactive Hindi Story ЁЯОЙ</h1>
<div id="story">рдХрд╣рд╛рдиреА рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред</div>
<button id="startBtn">рд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдЯреЛрд░реА</button>
<button id="speakBtn">ЁЯЧгя╕П рдмреЛрд▓реЛ рдЙрддреНрддрд░</button>
<div id="options"></div>

<script>
  const storyDiv = document.getElementById('story');
  const startBtn = document.getElementById('startBtn');
  const speakBtn = document.getElementById('speakBtn');
  const optionsDiv = document.getElementById('options');

  // ===== Story JSON with branching paths =====
  const story = {
    1: {
      text: "рд░рд╛рдЬреВ рдЬрдВрдЧрд▓ рдореЗрдВ рдЦреЗрд▓ рд░рд╣рд╛ рдерд╛ред рддреБрдо рдХреНрдпрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣реЛрдЧреЗ?",
      options: [
        {text: "рдкреЗрдбрд╝ рдкрд░ рдЪрдврд╝рдирд╛", next: 2},
        {text: "рдирджреА рдХреЗ рдкрд╛рд╕ рдЬрд╛рдирд╛", next: 3}
      ]
    },
    2: {
      text: "рд░рд╛рдЬреВ рдкреЗрдбрд╝ рдкрд░ рдЪрдврд╝ рдЧрдпрд╛ рдФрд░ рдПрдХ рдкрдХреНрд╖реА рджреЗрдЦрд╛ред рдХреНрдпрд╛ рд╡рд╣ рдкрдХреНрд╖реА рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛?",
      options: [
        {text: "рд╣рд╛рдБ", next: 4},
        {text: "рдирд╣реАрдВ", next: 5}
      ]
    },
    3: {
      text: "рд░рд╛рдЬреВ рдирджреА рдХреЗ рдкрд╛рд╕ рдЧрдпрд╛ рдФрд░ рдордЫрд▓реА рджреЗрдЦреАред рдХреНрдпрд╛ рд╡рд╣ рдордЫрд▓реА рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛?",
      options: [
        {text: "рд╣рд╛рдБ", next: 6},
        {text: "рдирд╣реАрдВ", next: 7}
      ]
    },
    4: {text: "рд░рд╛рдЬреВ рдиреЗ рдкрдХреНрд╖реА рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдФрд░ рдЙрд╕рдиреЗ рдЙрдбрд╝рд╛рди рднрд░реАред рдХрд╣рд╛рдиреА рд╕рдорд╛рдкреНрдд!", options: []},
    5: {text: "рд░рд╛рдЬреВ рдиреЗ рдкрдХреНрд╖реА рдХреЛ рджреЗрдЦрдиреЗ рдХрд╛ рдЖрдирдВрдж рд▓рд┐рдпрд╛ред рдХрд╣рд╛рдиреА рд╕рдорд╛рдкреНрдд!", options: []},
    6: {text: "рд░рд╛рдЬреВ рдиреЗ рдордЫрд▓реА рдкрдХрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдФрд░ рд╡рд╣ рдмрдЪ рдЧрдИред рдХрд╣рд╛рдиреА рд╕рдорд╛рдкреНрдд!", options: []},
    7: {text: "рд░рд╛рдЬреВ рдиреЗ рдордЫрд▓реА рдХреЛ рджреЗрдЦрдиреЗ рдХрд╛ рдЖрдирдВрдж рд▓рд┐рдпрд╛ред рдХрд╣рд╛рдиреА рд╕рдорд╛рдкреНрдд!", options: []}
  };

  let currentId = 1;

  // ===== Text-to-Speech =====
  function speak(text) {
    const msg = new SpeechSynthesisUtterance(text);
    msg.lang = 'hi-IN';
    window.speechSynthesis.speak(msg);
  }

  // ===== Start Story =====
  startBtn.onclick = () => {
    currentId = 1;
    showStory(currentId);
  }

  function showStory(id) {
    const node = story[id];
    storyDiv.innerHTML = node.text;
    speak(node.text);
    showOptions(node.options);
  }

  // ===== Show Options =====
  function showOptions(options) {
    optionsDiv.innerHTML = "";
    if (!options || options.length === 0) {
      speak("рдХрд╣рд╛рдиреА рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдИ рд╣реИред");
      return;
    }
    options.forEach(opt => {
      const btn = document.createElement("button");
      btn.className = "optionBtn";
      btn.innerText = opt.text;
      btn.onclick = () => {
        currentId = opt.next;
        showStory(currentId);
      };
      optionsDiv.appendChild(btn);
    });
  }

  // ===== Speech Recognition =====
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SpeechRecognition) {
    alert("рдЖрдкрдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рд╡реЙрдЗрд╕ рд░рд┐рдХрдЧреНрдирд┐рд╢рди рд╕рдкреЛрд░реНрдЯ рдирд╣реАрдВ рд╣реИред рдХреГрдкрдпрд╛ рдХреНрд░реЛрдо рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред");
  }
  const recognizer = new SpeechRecognition();
  recognizer.lang = 'hi-IN';
  recognizer.continuous = false;

  speakBtn.onclick = () => {
    const node = story[currentId];
    if (!node.options || node.options.length === 0) {
      storyDiv.innerHTML = "рдХрд╣рд╛рдиреА рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдИ рд╣реИред";
      speak("рдХрд╣рд╛рдиреА рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдИ рд╣реИред");
      return;
    }
    speak("рдХреГрдкрдпрд╛ рдЙрддреНрддрд░ рдмреЛрд▓реЗрдВред");
    recognizer.start();
  }

  recognizer.onresult = (event) => {
    const userAnswer = event.results[0][0].transcript.trim().toLowerCase();
    const node = story[currentId];
    const matchedOption = node.options.find(opt => userAnswer.includes(opt.text.toLowerCase()));

    if (matchedOption) {
      storyDiv.innerHTML = `рд╢рд╛рдмрд╛рд╢! рддреБрдордиреЗ рдЪреБрдирд╛: ${matchedOption.text}`;
      speak(`рд╢рд╛рдмрд╛рд╢! рддреБрдордиреЗ рдЪреБрдирд╛: ${matchedOption.text}`);
      currentId = matchedOption.next;
      setTimeout(() => showStory(currentId), 1500);
    } else {
      storyDiv.innerHTML = `рдХреЛрд╢рд┐рд╢ рдХрд░реЛ! рд╕рд╣реА рд╡рд┐рдХрд▓реНрдк рдмреЛрд▓реЛред`;
      speak("рдХреЛрд╢рд┐рд╢ рдХрд░реЛ! рд╕рд╣реА рд╡рд┐рдХрд▓реНрдк рдмреЛрд▓реЛред");
    }
  }
</script>
</body>
</html>
